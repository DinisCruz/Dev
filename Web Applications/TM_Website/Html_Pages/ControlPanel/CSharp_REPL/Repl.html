<!DOCTYPE html>

<html lang="en">
  <head>
    <title>C# REPL on the Web - using O2Platform's FluentSharp.CoreLib</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="A Browser based C# REPL">
    <meta name="author" content="Dinis Cruz">
    <meta name="author" content="O2 Platform">

    <!--[if lt IE 8]>
    <script>
      // Sorry.
      window.location = '/browser/';
    </script>
    <![endif]-->
    <!--
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Droid+Sans:regular,bold|Inconsolata|PT+Sans:400,700">    	
    -->
	<link href="bootstrap.css" rel="stylesheet" type="text/css" />
	<link href="gui.css" rel="stylesheet" type="text/css" />  <!-- based on the original src/css/jshint.css -->
	<link href="../WebEditor/CodeMirror/codemirror.css" rel="stylesheet" type="text/css" />    
    

	<script src="/Javascript/jQuery/jquery-1.8.1.min.js" type="text/javascript"></script>
	<script src="O2_REPL.js" type="text/javascript"></script>
	<script src="/Javascript/json/json2.js" type="text/javascript"></script>
    
	<script src="../WebEditor/CodeMirror/codemirror.js" type="text/javascript"></script>
	<script src="../WebEditor/CodeMirror/clike.js" type="text/javascript"></script>
    
    <script type="text/javascript">
  
		var executeCode = function()
			{
				$("#execute").html("Compiling");
				$('div.alert-message.success').fadeOut();				
				$('div.alert-message.error').fadeOut();				
				O2Platform.JS.executeCSharpCode(Editor.getValue(), showResult, showError);
			}

		var showResult = function(result)
			{
				if (result.search("Compilation failed:") > -1)
					showError(result)
				else
					$('div.alert-message.success').html(result).fadeIn();				
				
				$("#execute").html("Execute");
			}

		var showError = function(error)
			{
				$('div.alert-message.error').html(error).fadeIn();				
				$("#execute").html("Execute");
			}
	
		var loadCodeFromLocationID = function()
			{
				var id = location.pathname.substr(1);
				if (id!=="")
					$.get('/User_Snippets/' + id + '.html','', function(data) 
							{ 
								Editor.setValue(data);
								executeCode();
							})
			}
		var saveCode = function()
			{
				O2Platform.JS.saveSnippet(Editor.getValue(), function(id) { location = id});
			}
		$(function()
			{
				$("#execute").click(executeCode)				
				$('div.alert-message.info').click(executeCode);
				//loadCodeFromLocationID()
				O2Platform.JS.GetTeamMentorCRSF(executeCode);
			});

    </script>
  </head>

  <body>
    <div class="topbar-wrapper navigation">
      <div class="topbar">
        <div class="fill">
          <div class="container">
            <h3><a href="/">Web C# REPL (for TeamMentor)</a></h3>

            <ul>              
			  <li><a href="http://diniscruz.blogspot.co.uk/p/owasp-o2-platform.html"	target="_blank">What is the O2 Platform</a></li>           
              <li><a href="https://github.com/o2platform"								target="_blank">O2 Platform @ GitHub</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="container editor">
      <div class="editorArea">

		<div class="alert-message info">
          <p><span class="logo"><string>Web C# REPL</string></span> is a simple wrapper on O2 Platform's FluentSharp.CoreLib API</p>
		  <p>Note that all your script executions are logged (see link on top) so don't put any sensitive data here :)</p>
        </div>

		<textarea id="code" cols="120" rows="50">return TM_Xml_Database.Current.Path_XmlDatabase;
//using TeamMentor.CoreLib;
//O2Ref:TeamMentor.CoreLib.dll</textarea>
		
        <div class="buttons">			
			<button data-action="lint" class="btn danger" id="execute">Execute</button>
        </div>

		<br />

        <div class="alert-message error" style="display:none;">
			...
        </div>

        <div class="alert-message success" style="display:none;">
			...
        </div>

        

        
		
      </div>

    </div>

     

    <div class="footer">
      <p><strong>OWASP O2 Platform</strong></p>
      <p>Follow us on
        <a href="http://twitter.com/DinisCruz" target="_blank">Twitter</a> or
		<a href="http://diniscruz.blogspot.co.uk/" target="_blank">Blog</a> or
        <a href="https://github.com/o2plaform" target="_blank">GitHub</a>.        
      </p>
    </div>

    <script>
	

		var Editor = CodeMirror.fromTextArea(document.getElementById("code"), 
						{
							lineNumbers: true,
							matchBrackets: true,
							mode: "text/x-csharp"
						});

		Editor.focus();			
    </script>


  </body>
</html>
