

<h2>Install Library</h2>
<script>


	TM.ControlPanel.InstallLibraries = 
		{
				librariesZipFolder		: ""
			,	buildGui				: function()
					{
						this.applyCss();
						this.populateLibrariesZipFolder();
						this.populateListOfLibraries();
						this.setUpLibraryUploadForm();
					}
					
			, 	setUpLibraryUploadForm	: function()
				{

				}				 

			,	populateLibrariesZipFolder : function()
					{
						var that = this;
						TM.WebServices.Helper.invoke_TM_WebService('Get_LibrariesZip_Folder', {}, function(value) 
							{
								that.librariesZipFolder = value.replace(/\/\//g,"\/");
								$("#librariesFolder").html(this.librariesZipFolder);
							});					
					}
			,	populateListOfLibraries : function()
					{
						that = this;
						TM.WebServices.Helper.invoke_TM_WebService('Get_LibrariesZip_Folder_Files', {}, function(libraries) 
							{
								$.each(libraries, function(index, value)
									{										
										var libraryLink = $("<a href='#'/>").append(value)
																			.click(function()
																				{
																					console.log(" -> " +  that.librariesZipFolder );
																					var librarypPath = that.librariesZipFolder + "/" + value;
																					console.log("  ***  " +  librarypPath);
																					$("#fileOrUrl").val(librarypPath);
																					that.installLibrary();
																				});
										$("#availableLibraries").append($("<li>").append(libraryLink));
									});								
									
								//$("#availableLibraries a").first().click();	
							});
					}					
			, installLibrary			: function()
					{
						var libraryToInstall = $("#fileOrUrl").val();
						$("#installMessage").html("... installing library: " + libraryToInstall);
						TM.WebServices.Helper.invoke_TM_WebService('XmlDatabase_ImportLibrary_fromZipFile', 
																   { pathToZipFile : libraryToInstall } , function(result) 
							{
								if(result)									
									$("#installMessage").html($("<p>").append(" > Library installed was successful").css('color','green'));
								else
									$("#installMessage").html($("<p>").append(" > Library installation failed").css('color','red'));
							});	
						
					}
				
			,	applyCss				: function()  
					{
						$("input:[type=text]").addClass("ui-widget-content ui-corner-all")
											  .width(300);
											  
						$("#install").button()
									.css('font-size',12)
									.click(this.installLibrary);
						
						
						$("input:[type=file]").addClass("ui-widget-content ui-corner-all")
											  .width(300);
											  
						$("#upload").button()
									.css('font-size',12);
			
			
						$("#fileUploadIFrame").width("100%").height(50);
						$("#fileUploadDiv").load("views/File_Upload.html?time=".add_Time());
						
						//$("#fileUploadIFrame").attr('src', "pages/File_Upload.html?time=".add_Time());
					}
		}
	
	
	$(function() { TM.ControlPanel.InstallLibraries.buildGui() });
					
</script>


<br/>
<b>Current Libraries Zip Folder(server side):</b> <span id="librariesFolder"></span>

<br/>
<br/><h3>Available Libraries Zip files (click to install)</h3><br/>
<p id=available> 
	Note that instalation from Zip will override existing libraries with the same name 
</p>
<br/>
<ul>
	<div id="availableLibraries"></div>
</ul>
<br/><h3>Install Library from File or Url</h3><br/>
<!--<form id="installForm">
	<p>
		<b><label for="fileOrUrl">File (server-side) or Url:</label></b>
		<input type="text" id="fileOrUrl"> <input type="button" id="install" value="Install"/>
		<br/><br/>
		<span id="installMessage"> </div>
	</p>
</form>
-->
<div  id="fileUploadDiv" />

<iframe  id="fileUploadIFrame" />


<!--<br/><h3>Upload Library</h3><br/>
<form id="uploadForm"  action="/FileUpload.axd" method="POST" enctype="multipart/form-data">
	<input type="hidden" name="MAX_FILE_SIZE" value="100000" />
	<p>
		<b><label for="fileToUpload">File to upload:</label></b>
		<input type="file" id="fileToUpload"> 
		<input type="submit" id="upload" value="upload"/>
		<br/><br/>		
	</p>
</form>
-->

<span id="formOutput"> </div>
<!--
<h3>Upload Library</h3>
 <form id="uploadForm" action="files.php" method="POST" enctype="multipart/form-data">

                <input type="hidden" name="MAX_FILE_SIZE" value="100000" />

                File: <input type="file" name="file" id="file"/>

                Return Type: <select id="uploadResponseType" name="mimetype">

                    <option value="html">html</option>

                    <option value="json">json</option>

                    <option value="script">script</option>

                    <option value="xml">xml</option>

                </select>

                <input type="submit" value="Submit" id="submit"/>

            </form>
-->