<!DOCTYPE html>
 
<html xmlns="http://www.w3.org/1999/xhtml"> 
 
<head> 
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" /> 
    <title>TeamMentor | Login</title> 
    
    <link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/reset.css"      type="text/css" media="screen" title="no title" />
    <link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/text.css"       type="text/css" media="screen" title="no title" />
    <link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/buttons.css"    type="text/css" media="screen" title="no title" />
    <link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/login.css"      type="text/css" media="screen" title="no title" />
    <link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/forms.css"      type="text/css" media="screen" title="no title" />
    
    <script src="/aspx_Pages/scriptCombiner.ashx?s=WebServices_JS" type="text/javascript"></script>

    <script type="text/javascript">

        var buttonText = "Send Password Reset Link";
        var submittingText = "Submitting Request";
        var okText = "Back To HomePage";
        
        function changePasswordResponse(result)
        {									
            if(result === false) 
            {
                $("#loginFailed").fadeIn();
                $("#errorMessage").show().find("span").html('Change password failed');
                $("#loginSubmit").html(buttonText);
            }
            else
            {	
                $("#loginSubmit").html(okText);
                //document.location = "/TeamMentor";                
            }
        }

        var onSubmit = function()
            {
                $("#errorMessage").hide();
                $("#loginFailed").fadeOut();
                $("#loginSubmit").html(submittingText);
                var newPassword = $("#newPassword").attr('value');
                var passwordConfirm = $("#passwordConfirm").attr('value');
                console.log("changing password to with: " + newPassword + " : " + passwordConfirm);
                
            
                if (newPassword === "" || passwordConfirm ==="")		    
                    $("#errorMessage").show().find("span").html('You must provide both values');                
                else 
                {		            
                    var userToken = $("#UserToken").val();
                    var userName  = $("#UserName").val();
                    setTimeout(changePasswordResponse, 1000);
                    //TM.WebServices.WS_Users.passwordReset(userName, userToken, newPassword, changePasswordResponse);				                    
                }            
                return false; 
            };
            
        $(function()
            {
                $("#loginSubmit").html(buttonText);
                //css fixes
                $("#errorMessage").hide()
                                  .absolute()
                                  .left(100)
                                  .top(67);
                $("h1").css('background-image','/Images/HeaderImage.jpg')
                $("#SI_Logo").width(250);			
                $(".form").height(209);	
                $("#pageTitle").absolute().top(30).left(260);
                //set the click event for the login button 
                $("#loginSubmit").click(onSubmit);
        });
    </script>
</head> 
 
<body> 

<div id="login">
    
    <div id="login_panel">		
        <img src='/Images/HeaderImage.jpg' id='SI_Logo'/>	        
        <form class="form">
            <div id="pageTitle">
                <h3>Forgot Password</h3>		
            </div>			
            <div class="login_fields">
                <input type="hidden" id = "UserName"/> 
                <input type="hidden" id = "UserToken"/>
                <div class="field">
                    <label for="newPassword">UserName</label>					
                    <input type="input" name="newPassword" value="" id="newPassword" tabindex="1" />		
                    <div class="error" id="errorMessage"><span>...</span></div>
                </div>
                
                
                <div class="field">
                    <label for="passwordConfirm">Email</label>
                    <input type="input" name="passwordConfirm" value="" id="passwordConfirm" tabindex="2" />			
                </div>
            </div> <!-- .login_fields -->
            
            <div class="login_actions">				
                <button id="loginSubmit" class="btn primary" tabindex="3"></button>
            </div>
            
        </form>
    </div> <!-- #login_panel -->		
</div> <!-- #login -->

</body> 
 
</html>